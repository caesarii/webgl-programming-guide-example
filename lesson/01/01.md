# 01 webgl 入门

## webgl 简介
webgl 是用来在网页上绘制和渲染复杂三维图形的技术

类比DOM, DOM 是在网页中操作文档和样式的api, webgl是在网页中渲染3D图形的api

webgl 与 opengl 的关系
  opengl是操作系统级的编程接口, 使用 C/C++ 开发桌面软件
  webgl 使用 js 开发的web应用
  webgl 基于 opengl 特定版本(opengl es), webgl 与 opengl 使用相同的着色器语言(GLSL)
  GLSL是用来控制渲染的领域特定语言, 可以类比网页中的CSS, 相同点: 内嵌在另一种语言中, 控制特定行为, 具有特殊的语法

webgl 与 canvas 的关系
通过 canvas 有两套 api 可以使用
一套是 2d 图形 api(见图 canvas-2d.png), 这一套是 web api
第二套是 webgl, 3d图形 api (见demo: HelloCanvas)

HelloCanvas 只绘制了背景颜色的 webgl demo
  了解如何创建 webgl context
  webgl api 的一般模式
  webgl 中色值的格式
 
## 绘制图形 --- 点
使用 webgl 绘制图形必须使用可编程着色器

什么是着色器
  着色器生成渲染数据
渲染数据是什么, 为什么需要着色器: 渲染原理
  假定有一个分辨率为 100*100 的屏幕, 每个像素用 rgba 四个参数控制, 这样有一个 100*100*4 的数组就可以完全表示控制这个屏幕的显示
  但这样直接操纵像素数组只有理论上的可行性, 实际使用需要更友好的api, 思路就是将绘制图形分为三步
  1. 使用顶点来描述图形, 所有模型无论2d/3d都分解为三角形拼接的图形
  2. 指定顶点的链接方式即图形(给定四个点, 有多个连接方式, 只有指定图形是 rect 才能绘制长方形)
  3. 在顶点模型的基础上, 确定顶点上以及顶点之间的所有像素的数据

对应 webgl, drawXXX api 指定顶点的连接方式, 顶点着色器生成每个顶点的坐标, 片元着色器生成每个像素的数据(颜色等)

demo: HelloPoint1
  程序结构
    获取webgl context
    载入着色器: 加载和编译着色器代码, initShaders 之后着色器处于待绘制状态
    清除背景
    绘制图形
  
  glsl 语法: 参见代码注释

  重点是理解 webgl 与 glsl 之间的关系: 
    在调用 draw 之后按照 draw 指定的顶点个数 count 调用 count 次顶点着色器, 拿到所有顶点的坐标
    然后调用片元着色器, 生成所有顶点/顶点之间的所有像素数据

坐标系统
  右手坐标系: 原点在绘制空间中心, x 轴正向水平向右, y轴正向垂直向上, z轴正向垂直屏幕向外, 见图<右手坐标系.png>
  webgl 使用齐次坐标表示点: (x, y, z, w), 等价于 (x/w, y/w, z/w) 
  假定有一个绘制空间(绘制空间即三维上的绘制区域)如图所示, 使用齐次坐标表示坐标轴上的各个点, 如 x 轴 (100, 0, 0, 100), (-100, 0, 0, 100), y轴(0, 100, 0, 100), (0, -100, 0, 100), 使用三维坐标则表示为(1, 0, 0), (-1, 0, 0)...

  网页/canvas 2d api的坐标系: x 轴正向水平向右, y轴正向垂直向下, 所以通过DOMapi获取的坐标在传递到webgl时需要时需经过换算

## 从 js 向 glsl 传递数据
点的数据是硬编码在顶点着色器中, 如何实现 clickPoint(在鼠标点击的位置绘制点)
  从 js 向着色器传递数据, 两种语言中传递数据, 内存
x
GLSL 中传递数据的机制: attribute 类型的变量
  在着色器中声明和使用 attribute 类型变量
  在 webgl 中向着色器中声明的 attribute 传输数据
  demo: HelloPoint2

## 作业
1. 基于 HelloCanvas 实现点击切换背景颜色
2. 基于 HelloPoint1, 在不同位置绘制点, 了解坐标系
3. 基于 HelloPoint2 实现在鼠标点击的位置绘制点
4. 基于作业3, 使用 uniform 变量实现不同颜色的点(颜色可以随机, 也可以基于坐标象限)
